<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Môj doplnkový cyklus 💊</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#3b82f6" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Doplnkový cyklus" />
  <link rel="apple-touch-icon" href="./cyklus.png" />
  <meta property="og:image" content="./cyklus.png" />
  <link rel="icon" type="image/png" href="./cyklus.png" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: linear-gradient(to bottom, #e6f0ff, #f8fbff);
      font-family: 'Inter', sans-serif;
      text-align: center;
      padding: 20px;
    }
    .shine {
      position: relative;
      overflow: hidden;
    }
    .shine::before {
      content: "";
      position: absolute;
      top: 0;
      left: -75%;
      width: 50%;
      height: 100%;
      background: linear-gradient(
        120deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.6) 50%,
        rgba(255, 255, 255, 0) 100%
      );
      animation: shine 3s infinite;
    }
    @keyframes shine {
      0% { left: -75%; }
      100% { left: 125%; }
    }
  </style>
</head>
<body>
  <div class="max-w-md mx-auto mt-8 bg-white rounded-3xl shadow-2xl p-6">
    <img src="./cyklus.png" alt="Logo" class="mx-auto w-24 h-24 mb-3 rounded-full shadow-lg" />
    <h1 class="text-2xl font-extrabold text-black mb-2 flex items-center justify-center gap-2">
      💊 Môj doplnkový cyklus
    </h1>

    <div class="shine bg-gradient-to-r from-purple-500 to-purple-700 text-white font-semibold py-2 px-4 rounded-xl shadow-md mb-5">
      🌟 Vytvoril Ivan Kebra Nagast 🌟
    </div>

    <div class="flex gap-2 mb-4">
      <input id="supplementInput" type="text" placeholder="Názov doplnku..."
        class="flex-1 px-3 py-2 border rounded-lg shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-400" />
      <button id="addSupplement"
        class="shine bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-lg shadow-md font-semibold">
        Pridať
      </button>
    </div>

    <button id="resetAll"
      class="shine bg-gradient-to-r from-red-500 to-red-700 text-white font-semibold py-2 px-4 rounded-lg w-full mb-2 shadow-md">
      🧹 Resetovať dáta
    </button>

    <button id="enableNotifs"
      class="shine bg-gradient-to-r from-green-500 to-green-700 text-white font-semibold py-2 px-4 rounded-lg w-full mb-4 shadow-md">
      🔔 Povoliť notifikácie
    </button>

    <h2 class="text-gray-700 mb-2 font-semibold">Aktuálny deň:</h2>
    <div id="progressCircle"
      class="w-32 h-32 border-4 border-gray-300 rounded-full mx-auto flex items-center justify-center text-2xl font-bold text-gray-600">
      0%
    </div>

    <div id="supplement-list" class="mt-6 space-y-3"></div>
  </div>

  <script>
    // Načítanie uložených doplnkov
    function render() {
      const listEl = document.getElementById("supplement-list");
      if (!listEl) return;

      listEl.innerHTML = "";
      const supplements = JSON.parse(localStorage.getItem("supplements")) || [];

      supplements.forEach((s, i) => {
        const div = document.createElement("div");
        div.className = `p-4 rounded-xl text-white shadow-md ${s.color === "red"
          ? "bg-gradient-to-r from-red-500 to-red-700"
          : "bg-gradient-to-r from-green-500 to-green-700"}`;
        div.innerHTML = `
          <div class="flex justify-between items-center">
            <div>
              <h3 class="text-xl font-bold">${s.name}</h3>
              <p class="text-sm">${s.dose}</p>
            </div>
            <input type="time" value="${s.time}" class="rounded text-black px-2 py-1" />
          </div>
        `;
        listEl.appendChild(div);
      });
    }

    // Pridanie nového doplnku
    document.getElementById("addSupplement").addEventListener("click", () => {
      const input = document.getElementById("supplementInput");
      const name = input.value.trim();
      if (!name) return alert("Zadaj názov doplnku!");

      const supplements = JSON.parse(localStorage.getItem("supplements")) || [];
      supplements.push({
        name,
        dose: "1 ks ráno",
        time: "08:00",
        color: supplements.length % 2 === 0 ? "red" : "green"
      });
      localStorage.setItem("supplements", JSON.stringify(supplements));
      input.value = "";
      render();
    });

    // Reset dát
    document.getElementById("resetAll").addEventListener("click", () => {
      if (confirm("Naozaj chceš vymazať všetky dáta?")) {
        localStorage.removeItem("supplements");
        render();
      }
    });

    // Povolenie notifikácií
    document.getElementById("enableNotifs").addEventListener("click", () => {
      Notification.requestPermission().then((perm) => {
        if (perm === "granted") alert("Notifikácie boli povolené!");
        else alert("Notifikácie neboli povolené.");
      });
    });

    document.addEventListener("DOMContentLoaded", render);

    // Service Worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
</body>
</html>
